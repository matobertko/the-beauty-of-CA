<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Beauty of CA</title>
    <link href="style.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.min.js"></script>  
    <!-- This code uses online version of the p5.js library. -->
    <!-- Acknowledgment: Parts of this code were guided, modified or generated by these AI tools: Studio AI, ChatGPT, Claude.AI.  -->
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <h1>The Beauty of CA</h1>

            <select class="dropdown" id="modeSelect">
                <option value="pattern-generator">CA Pattern Generator</option>
                <option value="image-modifier">Image Modifier</option>
            </select>

            <div id="imageModifierMode" style="display: none;">
                <div class="section">
                    <div class="input-label">Load Image (PNG/JPG):</div>
                    <div class="drop-zone" id="drop-zone">
                    Drop image or <u>Browse</u>.
                    </div>
                    <input type="file" id="file-input" class="hidden-input" accept="image/png, image/jpeg, image/jpg" />

                    <div class="checkbox-group">
                        <input type="checkbox" id="showOriginal" class="checkbox">
                        <label for="showOriginal">show original</label>
                    </div>
                    
                    <div class="canvas-container">
                        <div id="imagePreviewCanvas"></div>
                    </div>

                    <div class="section-title">Parameters:</div>
                    
                    <div class="input-group">
                        <div class="input-label">Cell Size:</div>
                        <div class="slider-container">
                            <input type="range" class="slider" id="imageCellSize" min="2" max="10" step="1" value="2">
                            <span class="slider-value" id="cellSizeValue">2</span>
                        </div>
                    </div>

                    <div class="color-inputs">
                        <div class="color-group">
                            <div class="input-label">The lightest color:</div>
                            <input type="color" class="color-input" id="pattern-bg-2" value="#ffffff">
                        </div>
                        <button class="btn swap-btn" id="swap-color-btn-2">⇆</button>
                        <div class="color-group">
                            <div class="input-label">The darkest color:</div>
                            <input type="color" class="color-input" id="pattern-fg-2" value="#000000">
                        </div>
                    </div>

                    <div class="input-group">
                        <div class="input-label">Number of colors:</div>
                        <div style="font-size: 12px; color: #999; margin-bottom: 8px;">
                            Number of colors and therefore number of CAs for the imported image.
                        </div>
                        
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <button class="btn" id="decreaseBtn">-</button>
                            <span id="levelDisplay">3</span>
                            <button class="btn" id="increaseBtn">+</button>
                        </div>
                        
                    </div>

                    <div style="font-size: 12px; color: #999; margin-bottom: 8px;">
                        Choose CA for each of the levels bellow, starting from the second darkest to the brightest.
                    </div>

                    <div id="slidersContainer"></div>
                    
                    <div id="canvasOverlay" class="canvas-container" style="display: none;">
                        <!-- p5 canvas will be created here -->
                    </div>
                </div>
            </div>

            <div id="patternGeneratorMode">
                <div class="section">
                    <div class="section-title">CA parameters:</div>

                    <div class="input-group">
                        <div class="input-label">Rule code:</div>
                        <div class="slider-container">
                            <input type="range" class="slider" id="patternRule" min="0" max="255" value="30">
                            <span class="slider-value">30</span>
                        </div>
                    </div>

                    <div class="input-group">
                        <div class="input-label">Cell Size:</div>
                        <div class="slider-container">
                            <input type="range" class="slider" id="patternCellSize" min="2" max="32" value="16">
                            <span class="slider-value">16</span>
                        </div>
                    </div>

                    <div class="input-group">
                        <div class="input-label">Randomness:</div>
                        <div class="slider-container">
                            <input type="range" class="slider" id="patternRandomness" min="0" max="1" step="0.01" value="0">
                            <span class="slider-value">0</span>
                        </div>
                    </div>

                    <div class="input-group">
                        <div class="input-label">Boundary Condition:</div>
                        <select class="select-input" id="patternBoundary">
                            <option value="mirror">Mirror</option>
                            <option value="periodic">Periodic</option>
                            <option value="copy">Copy</option>
                            <option value="fg">Foreground (1)</option>
                            <option value="bg">Background (0)</option>
                        </select>
                    </div>

                    <div class="color-inputs">
                        <div class="color-group">
                            <div class="input-label">Foreground:</div>
                            <input type="color" class="color-input" id="pattern-fg" value="#000000">
                        </div>
                        <button class="btn swap-btn" id="swap-color-btn">⇆</button>
                        <div class="color-group">
                            <div class="input-label">Background:</div>
                            <input type="color" class="color-input" id="pattern-bg" value="#ffffff">
                        </div>
                    </div>

                    <div class="canvas-container">
                        <div id="patternPreviewCanvas"></div>
                    </div>
                </div>
            </div>

            <button class="generate-btn" id="generateBtn">Generate render!</button>

            <div class="export-section">
                <div class="section-title">Export Render and Parameters:</div>
                <div class="export-buttons">
                    <select class="select-input" id="quality-select">
                        <option value="0.5">0.5x</option>
                        <option value="1" selected>1x</option>
                        <option value="2">2x</option>
                        <option value="3">3x</option>
                        <option value="4">4x</option>
                        <option value="8">8x</option>
                        <option value="16">16x</option>
                    </select>
                    <button class="btn">JPG</button>
                    <button class="btn">PNG</button>
                    <button class="btn">Save Parameters</button>
                    <button class="btn">Load Parameters</button>
                </div>
            </div>

            <div style="margin-top: 32px; display: flex; justify-content: flex-end;">
                <span class="link" id="aboutLink">About the project</span>
                <span class="link" id="helpLink">Manual</span>
            </div>
        </div>

        <div class="main-content">
            <div class="render-placeholder" id="mainCanvas">
            </div>
            <button id="toggleUIPanel" class="toggle-ui-btn">Hide UI Panel</button>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal" id="aboutModal">
        <div class="modal-content">
            <span class="modal-close" id="modalClose">&times;</span>
            <h2>About The Beauty of CA</h2>
            <p>The Beauty of CA (Cellular Automata) is an interactive web application that explores the fascinating world of cellular automata. This project allows you to generate beautiful patterns and modify images using mathematical rules that govern how cells evolve over time. Experiment with different rules, cell sizes, and parameters to discover the endless beauty hidden within these mathematical systems.</p>
            <h2>What are Cellular automata?</h2>
            <p style="color: #999; font-style: italic;">cellular automaton • pl. cellular automata • abbrev. CA</p>
            <p>Cellular automata are discrete mathematical models that consist of a grid of cells, each of which can be in a finite number of states. The cells evolve according to a set of rules based on the states of neighboring cells, creating complex and often beautiful patterns from simple initial conditions.</p>
            <h2>About the Author</h2>        
            <p>This project was created by Martin Bertko, student of the Visual Informatics Department at the Faculty of Informatics (Masaryk University, Brno) as a part of PV097 course in the spring semester 2025.</p>
        </div>
    </div>
    <div class="modal" id="helpModal">
        <div class="modal-content">
            <span class="modal-close" id="helpModalClose">&times;</span>
            <h2>Manual</h2>
            <p>This application offers two main modes: <b>Image Modifier</b> for applying CA rules to existing images, and <b>Pattern Generator</b> for creating original CA patterns from scratch.</p> 
            <h2>Structure of the web application</h2>
            <p>The screen is divided into two parts: <b>UI panel</b> and <b>Render Screen</b>.</p>
            <h3>UI panel</h3>
            <p>This application offers two main modes: Image Modifier for applying CA to the imported image and Pattern Generator for creating original CA patterns from scratch. Both can be selected at the top of the panel. Furthermore, both share the “Generate render” button and export features of the renders (export render as JPG, PNG in one of the following qualities: 0.5x, 1x, 2x, 3x, 4x, 8x, 16x) or parameters (export file is JSON file, only which can be imported into the application).</p>
            <h3>Render Screen</h3>
            <p>The content of the render screen is produced by the button “Generate render” only. The size of the render screen is responsive to the change of the windows and can be enlarged by toggling the UI panel through the “Hide (Show) UI Panel” in the bottom left corner of the screen.</p>
            <h2>Pattern Generator</h2>
            <p>Predefined option. It allows the user to create patterns from the set of the elementary CA (256 rules, thus 256 possible outcomes) with the chosen influence of randomness and scale.</p>
            <p>The <b>randomness slider</b> picks a number, determining the probability of each cell getting colored by the foreground color in the first row (initialization row).</p>
            <p><b>Boundary conditions</b> decide how to handle cells on the left and right border of the render plane:</p>
            <ul style="padding-left: 20px;">
                <li>“mirror” (default) – Reflects edge values: out-of-bounds left returns second cell, right returns second-to-last.</li>
                <li>“copy” – Extends edge values: out-of-bounds left returns first cell, right returns last.</li>
                <li>“fg” – Fills out-of-bounds with 1 (foreground).</li>
                <li>“bg” – Fills out-of-bounds with 0 (background).</li>
                <li>“periodic” – Wraps around the array like a loop.</li>
            </ul> 
            <h2>Image Modifier</h2>
            <p>Image, which the application will work with, can be imported by clicking into the dashed rectangle or drag & drop it into the rectangle. Image preview shows the image in the k={2, …, 6} colors. k can be set by the counter below the image preview (default: k=3). The image preview works only in shades of grey.</p>
            <p>Users can decide the elementary rule for all CA by the sliders below the counter. The <b>sliders</b> that handle the rules are ordered from the second darkest (the darkest color doesn’t have CA for better visual effect) to the lightest. Dragging the sliders shows the preview of the CA of a particular rule. In this mode, CA has incorporated random generation of their first rows, which means that each generation with the same parameters can lead to slightly different results. This is intentional by both the essence of the application and implementation reasons.</p>
        </div>
    </div>

    <script src="main.js"></script>
</body>

</html>